<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dead Code Elimination â€¢ rco</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dead Code Elimination">
<meta property="og:description" content="rco">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rco</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Optimizers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/opt-common-subexpr.html">Common Subexpression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-constant-folding.html">Constant Folding</a>
    </li>
    <li>
      <a href="../articles/opt-constant-propagation.html">Constant Propagation</a>
    </li>
    <li>
      <a href="../articles/opt-dead-code.html">Dead Code Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-expr.html">Dead Expression Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-dead-store.html">Dead Store Elimination</a>
    </li>
    <li>
      <a href="../articles/opt-loop-invariant.html">Loop-invariant Code Motion</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contributing-an-optimizer.html">Contributing an Optimizer</a>
    </li>
    <li>
      <a href="../articles/potential-optimizers.html">Potential Optimizers</a>
    </li>
    <li>
      <a href="../articles/docker-readme.html">Docker Image</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jcrodriguez1989/rco/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="opt-dead-code_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dead Code Elimination</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jcrodriguez1989/rco/blob/master/vignettes/opt-dead-code.Rmd"><code>vignettes/opt-dead-code.Rmd</code></a></small>
      <div class="hidden name"><code>opt-dead-code.Rmd</code></div>

    </div>

    
    
<div id="dead-code-elimination" class="section level1">
<h1 class="hasAnchor">
<a href="#dead-code-elimination" class="anchor"></a>Dead Code Elimination</h1>
<div id="idea" class="section level2">
<h2 class="hasAnchor">
<a href="#idea" class="anchor"></a>Idea</h2>
<p>Dead code are pieces of code that do not affect the output of a program. The removal of these unnecessary code lines can be defined as Dead Code Elimination. These code lines do not serve any purpose in the main program flow because these codes will never be executed mainly because the condition for their execution is logically impossible/infeasible. This removal results in performance enhancements.</p>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Dead Code Elimination is an optimization that removes code which does not affect the program results. You might wonder why someone would write this type of source code, but it can easily creep into large, long-lived programs even at the source code level. Removing such code has several benefits: it shrinks program size and it allows the running program to avoid executing irrelevant operations, which reduces its running time. It can also enable further optimizations by simplifying program structure.</p>
<p>For example, consider the following code:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">foo</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">24</span>
  <span class="kw">if</span> (<span class="no">a</span> <span class="kw">&gt;</span> <span class="fl">25</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">25</span>)
    <span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">25</span> <span class="co"># dead code</span>
  }
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">a</span>)
  <span class="no">b</span> <span class="kw">&lt;-</span> <span class="fl">24</span> <span class="co"># dead code</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">b</span>) <span class="co"># dead code</span>
}</pre></body></html></div>
<p>In functions, after calling <code>return</code>, the following code would not be executed, so it is dead code and can be eliminated. In this example, resulting in:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">foo</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">24</span>
  <span class="kw">if</span> (<span class="no">a</span> <span class="kw">&gt;</span> <span class="fl">25</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">25</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">a</span>)
}</pre></body></html></div>
<p>Also, after constant <a href="opt-constant-propagation.html">propagating</a> and <a href="opt-constant-folding.html">folding</a> we would get:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">foo</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">24</span>
  <span class="kw">if</span> (<span class="fl">FALSE</span>) { <span class="co"># dead code</span>
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fl">25</span>) <span class="co"># dead code</span>
  } <span class="co"># dead code</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">a</span>)
}</pre></body></html></div>
<p>So it could be reduced to:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">foo</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">24</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">a</span>)
}</pre></body></html></div>
<p>This dead code optimizer also removes code after <code>next</code> or <code>break</code> calls.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Consider the following example:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">code</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(
  <span class="st">"i &lt;- 0"</span>,
  <span class="st">"n &lt;- 1000"</span>,
  <span class="st">"while (i &lt; n) {"</span>,
  <span class="st">"  if (TRUE) {"</span>,
  <span class="st">"    i &lt;- i + 1"</span>,
  <span class="st">"  } else {"</span>,
  <span class="st">"    i &lt;- i - 1"</span>,
  <span class="st">"  }"</span>,
  <span class="st">"}"</span>,
  <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"\n"</span>
)
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">code</span>)</pre></body></html></div>
<pre><code>## i &lt;- 0
## n &lt;- 1000
## while (i &lt; n) {
##   if (TRUE) {
##     i &lt;- i + 1
##   } else {
##     i &lt;- i - 1
##   }
## }</code></pre>
<p>Then, the automatically optimized code would be:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">opt_code</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/opt_dead_code.html">opt_dead_code</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">code</span>))
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">opt_code</span>$<span class="no">codes</span><span class="kw">[[</span><span class="fl">1</span>]])</pre></body></html></div>
<pre><code>## i &lt;- 0
## n &lt;- 1000
## while (i &lt; n) {
##   i &lt;- i + 1
## }</code></pre>
<p>And if we measure the execution time of each one, and the speed-up:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">bmark_res</span> <span class="kw">&lt;-</span> <span class="fu">microbenchmark</span>({
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="no">code</span>))
}, {
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="no">opt_code</span>))
})
<span class="fu">autoplot</span>(<span class="no">bmark_res</span>)</pre></body></html></div>
<p><img src="opt-dead-code_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu">speed_up</span>(<span class="no">bmark_res</span>)</pre></body></html></div>
<pre><code>##            Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
## Expr_2 56.76011 54.17558 46.81041 53.60603 54.20093 197.7563</code></pre>
</div>
<div id="implementation" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h2>
<p>The <code>opt_dead_code</code> optimizer performs two main tasks:</p>
<div id="remove-code-after-interruption-commands" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-code-after-interruption-commands" class="anchor"></a>Remove code after interruption commands</h3>
<p>All the code, that is equally-nested, found after a <code>break</code>, <code>next</code>, or <code>return</code> call is removed. Something important to note is that it assumes that <strong>the <code>return</code> function has not been overwritten</strong>.</p>
</div>
<div id="remove-constant-conditionals" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-constant-conditionals" class="anchor"></a>Remove constant conditionals</h3>
<p>This task has sub-items:</p>
<ul>
<li><p>Remove <code>FALSE</code> whiles: <code>while (FALSE) { expr }</code> expressions are removed from the code.</p></li>
<li><p>Remove <code>FALSE</code> ifs: <code>if (FALSE) { expr }</code> expressions are removed. And <code>if (FALSE) { expr1 } else { expr2 }</code> is replaced by <code>expr2</code>.</p></li>
<li><p>Replace <code>TRUE</code> ifs: <code>if (TRUE) { expr }</code> is replaced by <code>expr</code>. And <code>if (TRUE) { expr1 } else { expr2 }</code> is replaced by <code>expr1</code>.</p></li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Juan Cruz Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
